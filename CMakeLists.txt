cmake_minimum_required(VERSION 3.31)
project(TetrisAPI)

set(CMAKE_CXX_STANDARD 17)

find_package(SWIG REQUIRED)
include(UseSWIG)

find_package(Python3 REQUIRED COMPONENTS Development Interpreter)

include_directories(${CMAKE_CURRENT_SOURCE_DIR})

# üëá –í–∞–∂–Ω–æ: –∏–∑–±–µ–∂–∞—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è debug-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ Python
add_definitions(-DPy_NO_DEBUG)

set_source_files_properties(TetrisAPI.i PROPERTIES CPLUSPLUS ON)
swig_add_library(TetrisAPI
        LANGUAGE python
        SOURCES TetrisAPI.i TetrisAPI.cpp TetrisAPI.h
)

target_link_libraries(TetrisAPI PRIVATE Python3::Python)

if(WIN32)
    target_compile_definitions(TetrisAPI PRIVATE TetrisAPI_EXPORTS)

    # ‚ùå –£–±–∏—Ä–∞–µ–º –ø–æ–ø—ã—Ç–∫—É –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ python311_d.lib
    # ‚úÖ –í–º–µ—Å—Ç–æ —ç—Ç–æ–≥–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º release-–±–∏–±–ª–∏–æ—Ç–µ–∫—É –¥–∞–∂–µ –≤ Debug-—Å–±–æ—Ä–∫–µ
    if(CMAKE_BUILD_TYPE STREQUAL "Debug")
        message(STATUS "Using Release Python runtime in Debug build")
        # –£–±–µ–¥–∏–º—Å—è, —á—Ç–æ –Ω–∏–∫–∞–∫–∏–µ debug-—Ñ–ª–∞–≥–∏ Python –Ω–µ –º–µ—à–∞—é—Ç
        target_compile_definitions(TetrisAPI PRIVATE Py_NO_DEBUG)
    endif()
endif()